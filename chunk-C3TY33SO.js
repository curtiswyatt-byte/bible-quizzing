import{a as A}from"./chunk-7WO65EVB.js";import{b as W}from"./chunk-RURAUEF7.js";import{a as j}from"./chunk-KODUIQMG.js";import{c as z,f as F,j as D,k as Q,l as V,p as R}from"./chunk-GJ3ACHC3.js";import{Ea as E,Fa as I,H as c,Ha as N,M as y,N as w,Na as q,R as p,W as u,X as a,Y as i,a as S,aa as b,b as k,ba as d,ca as g,d as h,ha as s,ia as C,ja as T,ka as M,na as x,oa as P,pa as O,y as _,z as f}from"./chunk-45QSGMLT.js";function B(r,t){if(r&1&&(a(0,"option",21),s(1),i()),r&2){let e=t.$implicit;u("value",e),c(),C(e)}}function H(r,t){if(r&1){let e=b();a(0,"div",22),d("click",function(){let l=_(e).$implicit,m=g();return f(m.onTeam1PlayerClick(l,m.getNextEmptyChair(1)))}),s(1),i()}if(r&2){let e=t.$implicit;c(),M(" ",e.playerNumber," - ",e.name," ")}}function L(r,t){if(r&1){let e=b();a(0,"button",26),d("click",function(){_(e);let l=g().index,m=g();return f(m.onRemoveTeam1Chair(l))}),s(1,"Remove"),i()}}function U(r,t){if(r&1&&(a(0,"div",23)(1,"span"),s(2),i(),a(3,"span",24),s(4),i(),p(5,L,2,0,"button",25),i()),r&2){let e=t.$implicit,n=t.index;c(2),T("Chair #",n+1,":"),c(2),C(e?e.nickname||e.name:"Empty"),c(),u("ngIf",e)}}function Z(r,t){if(r&1&&(a(0,"option",21),s(1),i()),r&2){let e=t.$implicit;u("value",e),c(),C(e)}}function G(r,t){if(r&1){let e=b();a(0,"div",22),d("click",function(){let l=_(e).$implicit,m=g();return f(m.onTeam2PlayerClick(l,m.getNextEmptyChair(2)))}),s(1),i()}if(r&2){let e=t.$implicit;c(),M(" ",e.playerNumber," - ",e.name," ")}}function J(r,t){if(r&1){let e=b();a(0,"button",26),d("click",function(){_(e);let l=g().index,m=g();return f(m.onRemoveTeam2Chair(l))}),s(1,"Remove"),i()}}function K(r,t){if(r&1&&(a(0,"div",23)(1,"span"),s(2),i(),a(3,"span",24),s(4),i(),p(5,J,2,0,"button",25),i()),r&2){let e=t.$implicit,n=t.index;c(2),T("Chair #",n+1,":"),c(2),C(e?e.nickname||e.name:"Empty"),c(),u("ngIf",e)}}var $=class r{constructor(t,e,n,l){this.dbService=t;this.quizState=e;this.router=n;this.matchSettingsService=l}teams=[];team1Players=[];team2Players=[];selectedTeam1="";selectedTeam2="";team1Members=[];team2Members=[];team1Chairs=[null,null,null,null];team2Chairs=[null,null,null,null];ngOnInit(){return h(this,null,function*(){yield this.loadTeams();let t=this.quizState.getMatchState();t&&(this.selectedTeam1=t.team1Team,this.selectedTeam2=t.team2Team,this.selectedTeam1&&(yield this.loadTeam1Members()),this.selectedTeam2&&(yield this.loadTeam2Members()))})}loadTeams(){return h(this,null,function*(){this.teams=yield this.dbService.getAllTeams(),this.teams.sort()})}loadTeam1Members(){return h(this,null,function*(){if(!this.selectedTeam1)return;let t=yield this.dbService.getTeamMembers(this.selectedTeam1);this.team1Members=[];for(let e of t){let n=yield this.dbService.getPlayer(e);n&&this.team1Members.push(n)}this.team1Players=[...this.team1Members]})}loadTeam2Members(){return h(this,null,function*(){if(!this.selectedTeam2)return;let t=yield this.dbService.getTeamMembers(this.selectedTeam2);this.team2Members=[];for(let e of t){let n=yield this.dbService.getPlayer(e);n&&this.team2Members.push(n)}this.team2Players=[...this.team2Members]})}onTeam1Select(){return h(this,null,function*(){yield this.loadTeam1Members(),this.team1Chairs=[null,null,null,null]})}onTeam2Select(){return h(this,null,function*(){yield this.loadTeam2Members(),this.team2Chairs=[null,null,null,null]})}onTeam1PlayerClick(t,e){this.team1Players=this.team1Players.filter(n=>n.playerNumber!==t.playerNumber),this.team1Chairs[e]=t}onTeam2PlayerClick(t,e){this.team2Players=this.team2Players.filter(n=>n.playerNumber!==t.playerNumber),this.team2Chairs[e]=t}onRemoveTeam1Chair(t){let e=this.team1Chairs[t];e&&(this.team1Players.push(e),this.team1Chairs[t]=null)}onRemoveTeam2Chair(t){let e=this.team2Chairs[t];e&&(this.team2Players.push(e),this.team2Chairs[t]=null)}getNextEmptyChair(t){let e=t===1?this.team1Chairs:this.team2Chairs;for(let n=0;n<e.length;n++)if(e[n]===null)return n;return 0}onAccept(){return h(this,null,function*(){if(!this.selectedTeam1||!this.selectedTeam2){alert("Please select both teams");return}if(this.team1Chairs.filter(o=>o!==null).length===0||this.team2Chairs.filter(o=>o!==null).length===0){alert("Please select at least one player for each team");return}let t=this.quizState.getMatchState();if(!t||!t.setID){alert("Please select a question set before choosing teams."),this.router.navigate(["/select-question"]);return}let e=yield this.dbService.getUserFile(),n=e?`${e.quizIDPre}${e.quizIDNum}`:t.quizID||"QUIZ1",l=t.matchSettings??this.matchSettingsService.getSettings(),m=k(S({},t),{quizID:n,matchID:t.matchID||"MATCH1",team1Team:this.selectedTeam1,team2Team:this.selectedTeam2,team1Score:0,team2Score:0,team1Fouls:0,team1Errors:0,team1TOs:l.timeoutsPerTeam,team2Fouls:0,team2Errors:0,team2TOs:l.timeoutsPerTeam,questionNum:0,tieBreakNum:0,team1Chairs:this.team1Chairs.map((o,v)=>({playerNumber:o?.playerNumber||0,rosterPosition:v,name:o?o.nickname||o.name:"",quizOut:!1,errorOut:!1,bonusOnly:!1})),team2Chairs:this.team2Chairs.map((o,v)=>({playerNumber:o?.playerNumber||0,rosterPosition:v,name:o?o.nickname||o.name:"",quizOut:!1,errorOut:!1,bonusOnly:!1})),team1Roster:this.team1Members.map(o=>({playerNumber:o.playerNumber,activeQuestions:0,correct:0,errors:0,fouls:0,bonusCorrect:0,bonusErrors:0,quizOut:!1,errorOut:!1,bonusOnly:!1,name:o.name,nickname:o.nickname})),team2Roster:this.team2Members.map(o=>({playerNumber:o.playerNumber,activeQuestions:0,correct:0,errors:0,fouls:0,bonusCorrect:0,bonusErrors:0,quizOut:!1,errorOut:!1,bonusOnly:!1,name:o.name,nickname:o.nickname})),currentQuestionID:null,bonusQuestion:!1,finishQuest:!1,questionIds:t.questionIds?[...t.questionIds]:[],totalQuestions:t.totalQuestions,questionQueue:t.questionQueue?t.questionQueue.map(o=>S({},o)):[],questionHistory:[],matchSettings:l,pendingBonusTeam:null,pendingBonusSeat:null});this.quizState.setMatchState(m),this.router.navigate(["/quiz-session"])})}onCancel(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)(y(j),y(A),y(q),y(W))};static \u0275cmp=w({type:r,selectors:[["app-select-teams"]],decls:49,vars:8,consts:[[1,"select-teams-container"],[1,"select-teams-header"],[1,"btn","btn-secondary",3,"click"],[1,"select-teams-content"],[1,"teams-section"],[1,"team-section","team1"],[1,"team-header"],["name","selectedTeam1",1,"form-control","team-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"players-section"],[1,"player-list"],["class","player-item",3,"click",4,"ngFor","ngForOf"],[1,"chairs-section"],[1,"chairs-list"],["class","chair-item",4,"ngFor","ngForOf"],[1,"team-section","team2"],["name","selectedTeam2",1,"form-control","team-select",3,"ngModelChange","change","ngModel"],[1,"form-actions"],["type","button",1,"btn",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"player-item",3,"click"],[1,"chair-item"],[1,"chair-player"],["class","btn btn-danger btn-small",3,"click",4,"ngIf"],[1,"btn","btn-danger","btn-small",3,"click"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"h1"),s(3,"Select Teams for Match"),i(),a(4,"button",2),d("click",function(){return n.onCancel()}),s(5,"Cancel"),i()(),a(6,"div",3)(7,"div",4)(8,"div",5)(9,"div",6)(10,"h2"),s(11,"Team #1"),i(),a(12,"select",7),O("ngModelChange",function(m){return P(n.selectedTeam1,m)||(n.selectedTeam1=m),m}),d("change",function(){return n.onTeam1Select()}),a(13,"option",8),s(14,"Select Team"),i(),p(15,B,2,2,"option",9),i()(),a(16,"div",10)(17,"h3"),s(18,"Select Players"),i(),a(19,"div",11),p(20,H,2,2,"div",12),i()(),a(21,"div",13)(22,"h3"),s(23,"Chairs"),i(),a(24,"div",14),p(25,U,6,3,"div",15),i()()(),a(26,"div",16)(27,"div",6)(28,"h2"),s(29,"Team #2"),i(),a(30,"select",17),O("ngModelChange",function(m){return P(n.selectedTeam2,m)||(n.selectedTeam2=m),m}),d("change",function(){return n.onTeam2Select()}),a(31,"option",8),s(32,"Select Team"),i(),p(33,Z,2,2,"option",9),i()(),a(34,"div",10)(35,"h3"),s(36,"Select Players"),i(),a(37,"div",11),p(38,G,2,2,"div",12),i()(),a(39,"div",13)(40,"h3"),s(41,"Chairs"),i(),a(42,"div",14),p(43,K,6,3,"div",15),i()()()(),a(44,"div",18)(45,"button",19),d("click",function(){return n.onAccept()}),s(46,"Accept"),i(),a(47,"button",20),d("click",function(){return n.onCancel()}),s(48,"Cancel"),i()()()()),e&2&&(c(12),x("ngModel",n.selectedTeam1),c(3),u("ngForOf",n.teams),c(5),u("ngForOf",n.team1Players),c(5),u("ngForOf",n.team1Chairs),c(5),x("ngModel",n.selectedTeam2),c(3),u("ngForOf",n.teams),c(5),u("ngForOf",n.team2Players),c(5),u("ngForOf",n.team2Chairs))},dependencies:[N,E,I,R,Q,V,D,z,F],styles:[".select-teams-container[_ngcontent-%COMP%]{min-height:100vh;background-color:var(--xl-gray-light);padding:2rem}.select-teams-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.select-teams-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:var(--font-heading);font-size:2rem;color:var(--xl-blue-dark)}.select-teams-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.teams-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem;margin-bottom:2rem}.team-section[_ngcontent-%COMP%]{background-color:var(--xl-white);border-radius:8px;padding:1.5rem;box-shadow:0 2px 4px #0000001a}.team-section.team1[_ngcontent-%COMP%]{border-left:4px solid var(--team1-dark)}.team-section.team2[_ngcontent-%COMP%]{border-left:4px solid var(--team2-dark)}.team-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.team-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--xl-blue-dark);margin-bottom:.5rem}.team-select[_ngcontent-%COMP%]{width:100%}.players-section[_ngcontent-%COMP%]{margin-bottom:1.5rem}.players-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--xl-gray-dark);margin-bottom:.5rem}.player-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;border:1px solid var(--xl-gray-light);border-radius:4px}.player-item[_ngcontent-%COMP%]{padding:.5rem;cursor:pointer;border-bottom:1px solid var(--xl-gray-light);transition:background-color .2s}.player-item[_ngcontent-%COMP%]:hover{background-color:var(--xl-gray-light)}.player-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.chairs-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--xl-gray-dark);margin-bottom:.5rem}.chairs-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.chair-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background-color:var(--xl-gray-light);border-radius:4px}.chair-player[_ngcontent-%COMP%]{font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem}@media (max-width: 968px){.teams-section[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{$ as SelectTeamsComponent};
