import{a as O,b as P}from"./chunk-CMFTMOX3.js";import"./chunk-7WO65EVB.js";import"./chunk-KODUIQMG.js";import{Ea as C,Fa as D,H as i,Ha as I,M as m,N as _,Na as M,R as f,W as d,X as o,Y as n,aa as h,ba as v,ca as c,d as g,fa as y,ha as r,ia as p,ja as l,y as x,z as u}from"./chunk-45QSGMLT.js";function L(a,e){if(a&1&&(o(0,"section",7),r(1),n()),a&2){let t=c();i(),p(t.error)}}function k(a,e){if(a&1&&(o(0,"section",8),r(1),n()),a&2){let t=c();i(),p(t.message)}}function E(a,e){if(a&1){let t=h();o(0,"article",11)(1,"div",12)(2,"h2"),r(3),o(4,"span",13),r(5),n()(),o(6,"p",14),r(7),n()(),o(8,"div",15)(9,"div")(10,"strong"),r(11,"Dataset ID:"),n(),r(12),n(),o(13,"div")(14,"strong"),r(15,"Source:"),n(),r(16),n()(),o(17,"button",16),v("click",function(){let b=x(t).$implicit,w=c(2);return u(w.onActivate(b))}),r(18),n()()}if(a&2){let t=e.$implicit,s=c(2);y("active",t.id===s.activeDatasetId),i(3),l("",t.book," "),i(2),l("(",t.version,")"),i(2),p(t.description||"Dataset ready to load."),i(5),l(" ",t.id),i(4),l(" ",t.path),i(),d("disabled",s.loading||t.id===s.activeDatasetId),i(),l(" ",t.id===s.activeDatasetId?"Active":"Activate"," ")}}function F(a,e){if(a&1&&(o(0,"div",9),f(1,E,19,9,"article",10),n()),a&2){let t=c();i(),d("ngForOf",t.datasets)}}var S=class a{constructor(e,t,s){this.datasetCatalog=e;this.dataLoader=t;this.router=s}datasets=[];activeDatasetId=null;loading=!1;message="";error="";ngOnInit(){return g(this,null,function*(){try{this.datasets=yield this.datasetCatalog.getCatalog(),this.activeDatasetId=this.dataLoader.getActiveDatasetId(),this.datasets.length||(this.error="No datasets were found. Add entries to /public/datasets/catalog.json.")}catch(e){console.error("Failed to load dataset catalog:",e),this.error=e?.message||"Failed to load dataset catalog."}})}onActivate(e){return g(this,null,function*(){if(!(this.loading||e.id===this.activeDatasetId)){this.loading=!0,this.message="",this.error="";try{yield this.dataLoader.loadDataset(e,{persistSelection:!0,resetMatch:!0}),this.activeDatasetId=e.id,this.message=`${e.book} (${e.version}) is now active.`}catch(t){console.error("Failed to activate dataset:",t),this.error=t?.message||"Failed to activate dataset."}finally{this.loading=!1}}})}goHome(){this.router.navigate(["/"])}static \u0275fac=function(t){return new(t||a)(m(O),m(P),m(M))};static \u0275cmp=_({type:a,selectors:[["app-data-library"]],decls:12,vars:3,consts:[[1,"data-library-container"],[1,"data-library-header"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","dataset-grid",4,"ngIf"],[1,"data-library-footer"],[1,"btn","btn-secondary",3,"click"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"dataset-grid"],["class","dataset-card",3,"active",4,"ngFor","ngForOf"],[1,"dataset-card"],[1,"dataset-info"],[1,"dataset-version"],[1,"dataset-description"],[1,"dataset-meta"],[1,"btn",3,"click","disabled"]],template:function(t,s){t&1&&(o(0,"div",0)(1,"header",1)(2,"h1"),r(3,"Data Library"),n(),o(4,"p"),r(5,"Choose a book/version dataset to activate instantly."),n()(),f(6,L,2,1,"section",2)(7,k,2,1,"section",3)(8,F,2,1,"div",4),o(9,"footer",5)(10,"button",6),v("click",function(){return s.goHome()}),r(11,"Return to Main Menu"),n()()()),t&2&&(i(6),d("ngIf",s.error),i(),d("ngIf",s.message),i(),d("ngIf",s.datasets.length>0))},dependencies:[I,C,D],styles:[".data-library-container[_ngcontent-%COMP%]{max-width:960px;margin:0 auto;padding:2rem;display:flex;flex-direction:column;gap:1.5rem}.data-library-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem;font-weight:600}.alert-error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.alert-success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.dataset-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:1.25rem}.dataset-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:1.25rem;border-radius:.75rem;background:#f9fafb;border:2px solid transparent;box-shadow:0 6px 16px #0f172a14}.dataset-card.active[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 8px 24px #2563eb40}.dataset-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.dataset-version[_ngcontent-%COMP%]{font-weight:500;color:#2563eb}.dataset-description[_ngcontent-%COMP%]{margin:.5rem 0 0;color:#334155;min-height:2.5rem}.dataset-meta[_ngcontent-%COMP%]{font-size:.9rem;color:#475569;display:flex;flex-direction:column;gap:.25rem}.data-library-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.btn[_ngcontent-%COMP%]{padding:.65rem 1.25rem;border:none;border-radius:.5rem;background:#2563eb;color:#fff;font-weight:600;cursor:pointer;transition:transform .1s ease,box-shadow .1s ease}.btn[_ngcontent-%COMP%]:disabled{background:#93c5fd;cursor:not-allowed;box-shadow:none}.btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 6px 12px #2563eb59}.btn-secondary[_ngcontent-%COMP%]{background:#334155}.btn-secondary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 12px #3341554d}"]})};export{S as DataLibraryComponent};
