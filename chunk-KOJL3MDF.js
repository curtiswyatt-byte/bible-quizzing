import{a as F}from"./chunk-7WO65EVB.js";import{b as B}from"./chunk-RURAUEF7.js";import{a as k}from"./chunk-KODUIQMG.js";import{b as D,c as O,f as N,j as P,k as A,l as E,o as T,p as w}from"./chunk-GJ3ACHC3.js";import{Ea as z,Fa as I,H as c,Ha as x,M as d,N as b,Na as Q,R as h,W as p,X as n,Y as o,a as S,b as _,ba as g,ca as C,d as u,ha as a,ia as y,ka as M,na as f,oa as q,pa as v}from"./chunk-45QSGMLT.js";function W(r,e){if(r&1&&(n(0,"option",15),a(1),o()),r&2){let t=e.$implicit;p("value",t),c(),y(t)}}function j(r,e){if(r&1&&(n(0,"div",19),a(1),o()),r&2){let t=e.$implicit;c(),M(" Question ",t.questNum," (Bonus: ",t.bonusNum,") ")}}function $(r,e){if(r&1&&(n(0,"div",16)(1,"h3"),a(2,"Questions in Set:"),o(),n(3,"div",17),h(4,j,2,2,"div",18),o()()),r&2){let t=C();c(4),p("ngForOf",t.questArr)}}var R=class r{constructor(e,t,i,l){this.dbService=e;this.quizState=t;this.router=i;this.matchSettingsService=l}quizSets=[];selectedSet="";matchID="";questArr=[];ngOnInit(){return u(this,null,function*(){yield this.loadQuizSets()})}loadQuizSets(){return u(this,null,function*(){try{this.quizSets=yield this.dbService.getAllQuizSets(),this.quizSets.sort(),console.log(`Loaded ${this.quizSets.length} quiz sets:`,this.quizSets),this.quizSets.length===0&&alert("No quiz sets found. Please import data that includes quiz sets.")}catch(e){console.error("Error loading quiz sets:",e),alert("Error loading quiz sets. Please check the console.")}})}onSetSelect(){return u(this,null,function*(){if(!this.selectedSet){this.questArr=[];return}try{let e=yield this.dbService.getQuizSet(this.selectedSet);console.log(`Found ${e.length} items in set ${this.selectedSet}`),this.questArr=e.map(t=>({questNum:t.questNum,bonusNum:t.bonusNum})),this.questArr.length===0&&alert(`No questions found in set "${this.selectedSet}". The quiz set may not have been imported correctly.`)}catch(e){console.error("Error loading quiz set:",e),alert(`Error loading quiz set: ${e}`)}})}onAccept(){return u(this,null,function*(){if(!this.matchID.trim()){alert("A match name is required to begin the match.");return}if(!this.selectedSet){alert("A question set must be selected for a match to begin.");return}if(this.questArr.length===0){alert(`No questions found in set "${this.selectedSet}". Please choose another set or reimport your data.`);return}let e=this.questArr.map(m=>m.questNum),t=e.length,i=this.questArr.map(m=>S({},m)),l=this.quizState.getMatchState(),s=l?.matchSettings??this.matchSettingsService.getSettings();if(l){let m=_(S({},l),{setID:this.selectedSet,matchID:this.matchID.trim(),questionIds:e,totalQuestions:t,questionQueue:i,questionHistory:[],matchSettings:s});this.quizState.setMatchState(m)}else{let m={quizID:"",matchID:this.matchID.trim(),team1Team:"",team2Team:"",team1Score:0,team2Score:0,team1Fouls:0,team1Errors:0,team1TOs:0,team1Appeals:s.appealsPerTeam,team2Fouls:0,team2Errors:0,team2TOs:0,team2Appeals:s.appealsPerTeam,questionNum:0,tieBreakNum:0,team1Chairs:[],team2Chairs:[],team1Roster:[],team2Roster:[],setID:this.selectedSet,currentQuestionID:null,bonusQuestion:!1,finishQuest:!1,questionIds:e,totalQuestions:t,questionQueue:i,questionHistory:[],matchSettings:s,pendingBonusTeam:null,pendingBonusSeat:null};this.quizState.setMatchState(m)}this.router.navigate(["/select-teams"])})}onCancel(){this.router.navigate(["/"])}static \u0275fac=function(t){return new(t||r)(d(k),d(F),d(Q),d(B))};static \u0275cmp=b({type:r,selectors:[["app-select-question"]],decls:23,vars:4,consts:[[1,"select-question-container"],[1,"select-question-header"],[1,"select-question-content"],[1,"form-section"],[1,"form-group"],["for","matchID",1,"form-label"],["type","text","id","matchID","name","matchID","placeholder","Enter match ID","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","quizSet",1,"form-label"],["id","quizSet","name","selectedSet",1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","question-list",4,"ngIf"],[1,"form-actions"],["type","button",1,"btn",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"question-list"],[1,"quest-items"],["class","quest-item",4,"ngFor","ngForOf"],[1,"quest-item"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1"),a(3,"Select Match Set Up"),o()(),n(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5),a(8,"Match Title:"),o(),n(9,"input",6),v("ngModelChange",function(s){return q(i.matchID,s)||(i.matchID=s),s}),o()(),n(10,"div",4)(11,"label",7),a(12,"Select Question Set:"),o(),n(13,"select",8),v("ngModelChange",function(s){return q(i.selectedSet,s)||(i.selectedSet=s),s}),g("change",function(){return i.onSetSelect()}),n(14,"option",9),a(15,"Select Question Set"),o(),h(16,W,2,2,"option",10),o()(),h(17,$,5,1,"div",11),n(18,"div",12)(19,"button",13),g("click",function(){return i.onAccept()}),a(20,"Accept"),o(),n(21,"button",14),g("click",function(){return i.onCancel()}),a(22,"Cancel"),o()()()()()),t&2&&(c(9),f("ngModel",i.matchID),c(4),f("ngModel",i.selectedSet),c(3),p("ngForOf",i.quizSets),c(),p("ngIf",i.questArr.length>0))},dependencies:[x,z,I,w,A,E,D,P,O,T,N],styles:[".select-question-container[_ngcontent-%COMP%]{min-height:100vh;background-color:var(--xl-gray-light);padding:2rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.select-question-header[_ngcontent-%COMP%]{margin-bottom:2rem}.select-question-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:var(--font-heading);font-size:2rem;color:var(--xl-blue-dark)}.select-question-content[_ngcontent-%COMP%]{width:100%;max-width:500px}.form-section[_ngcontent-%COMP%]{background-color:var(--xl-white);border-radius:8px;padding:2rem;box-shadow:0 2px 4px #0000001a}.question-list[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:2px solid var(--xl-gray-light)}.question-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:var(--xl-blue-dark);font-size:1.1rem}.quest-items[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem}.quest-item[_ngcontent-%COMP%]{padding:.5rem;background-color:var(--xl-gray-light);border-radius:4px;font-size:.9rem}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:2rem}"]})};export{R as SelectQuestionComponent};
