import{a as F}from"./chunk-KODUIQMG.js";import{b as E,c as O,f as V,i as k,j as A,k as I,l as W,p as R}from"./chunk-GJ3ACHC3.js";import{Ea as w,Fa as M,H as m,Ha as P,M as T,N as x,Na as N,R as b,W as c,X as o,Y as r,aa as v,ba as p,ca as d,d as g,ha as s,ia as S,ka as C,na as _,oa as y,pa as f,y as u,z as h}from"./chunk-45QSGMLT.js";function B(i,t){if(i&1){let e=v();o(0,"div",15)(1,"label",16),s(2,"Team:"),r(),o(3,"input",17),f("ngModelChange",function(n){u(e);let l=d();return y(l.teamName,n)||(l.teamName=n),h(n)}),p("blur",function(){u(e);let n=d();return h(n.onTeamNameEnter())}),r()()}if(i&2){let e=d();m(3),_("ngModel",e.teamName)}}function L(i,t){if(i&1&&(o(0,"option",22),s(1),r()),i&2){let e=t.$implicit;c("value",e),m(),S(e)}}function j(i,t){if(i&1){let e=v();o(0,"div",15)(1,"label",18),s(2,"Team:"),r(),o(3,"select",19),f("ngModelChange",function(n){u(e);let l=d();return y(l.selectedTeam,n)||(l.selectedTeam=n),h(n)}),p("change",function(){u(e);let n=d();return h(n.onTeamSelect())}),o(4,"option",20),s(5,"Select Team"),r(),b(6,L,2,2,"option",21),r()()}if(i&2){let e=d();m(3),_("ngModel",e.selectedTeam),m(3),c("ngForOf",e.teams)}}function z(i,t){if(i&1&&(o(0,"option",26),s(1),r()),i&2){let e=t.$implicit;c("ngValue",e),m(),C(" ",e.name," ",e.nickname?"("+e.nickname+")":""," ")}}function Q(i,t){if(i&1){let e=v();o(0,"div",15)(1,"label",23),s(2,"Players:"),r(),o(3,"select",24),f("ngModelChange",function(n){u(e);let l=d();return y(l.selectedPlayer,n)||(l.selectedPlayer=n),h(n)}),p("change",function(){u(e);let n=d();return h(n.onPlayerSelect())}),o(4,"option",22),s(5,"Select Player"),r(),b(6,z,2,3,"option",25),r()()}if(i&2){let e=d();m(3),_("ngModel",e.selectedPlayer),m(),c("value",null),m(2),c("ngForOf",e.availablePlayers)}}function U(i,t){if(i&1){let e=v();o(0,"div",30)(1,"span"),s(2),r(),o(3,"button",31),p("click",function(){let n=u(e).$implicit,l=d(2);return h(l.onRemovePlayer(n))}),s(4,"Remove"),r()()}if(i&2){let e=t.$implicit;m(2),C("",e.playerNumber," - ",e.name)}}function q(i,t){if(i&1&&(o(0,"div",27)(1,"h3"),s(2,"Team Members:"),r(),o(3,"div",28),b(4,U,5,2,"div",29),r()()),i&2){let e=d();m(4),c("ngForOf",e.teamMembers)}}function G(i,t){if(i&1){let e=v();o(0,"button",32),p("click",function(){u(e);let n=d();return h(n.onAccept())}),s(1,"Accept"),r()}}var D=class i{constructor(t,e){this.dbService=t;this.router=e}mode="create";teams=[];players=[];availablePlayers=[];teamMembers=[];teamName="";selectedTeam="";selectedPlayer=null;ngOnInit(){return g(this,null,function*(){yield this.loadTeams(),yield this.loadPlayers()})}loadTeams(){return g(this,null,function*(){this.teams=yield this.dbService.getAllTeams(),this.teams.sort()})}loadPlayers(){return g(this,null,function*(){this.players=yield this.dbService.getAllPlayers(),this.players.sort((t,e)=>t.name.localeCompare(e.name)),this.updateAvailablePlayers()})}updateAvailablePlayers(){this.mode==="edit"&&this.selectedTeam?this.availablePlayers=this.players.filter(t=>!this.teamMembers.some(e=>e.playerNumber===t.playerNumber)):this.availablePlayers=[...this.players]}onModeChange(t){this.mode=t,this.teamName="",this.selectedTeam="",this.teamMembers=[],this.updateAvailablePlayers()}onTeamSelect(){return g(this,null,function*(){if(this.selectedTeam){if(this.mode==="rename"){let t=prompt(`Enter new team name for "${this.selectedTeam}":`);if(t&&t.trim())try{yield this.dbService.renameTeam(this.selectedTeam,t.trim()),yield this.loadTeams(),alert("Team renamed successfully!"),this.onModeChange("edit")}catch(e){console.error("Error renaming team:",e),alert("Error renaming team. Please try again.")}return}if(this.mode==="edit"){let t=yield this.dbService.getTeamMembers(this.selectedTeam);this.teamMembers=[];for(let e of t){let a=yield this.dbService.getPlayer(e);a&&this.teamMembers.push(a)}this.updateAvailablePlayers()}}})}onPlayerSelect(){return g(this,null,function*(){if(!this.selectedPlayer)return;let t=this.selectedPlayer.team?.trim()||"";if(t!==""&&!window.confirm(`${this.selectedPlayer.nickname||this.selectedPlayer.name} is already on ${t}. Do you wish to reassign?`)){this.selectedPlayer=null;return}if(this.teamMembers.some(e=>e.playerNumber===this.selectedPlayer.playerNumber)){alert("Player is already on the team."),this.selectedPlayer=null;return}this.teamMembers.push(this.selectedPlayer),this.selectedPlayer=null,this.updateAvailablePlayers()})}onRemovePlayer(t){return g(this,null,function*(){confirm(`Do you wish to remove ${t.name} from the team?`)&&(this.teamMembers=this.teamMembers.filter(e=>e.playerNumber!==t.playerNumber),this.updateAvailablePlayers())})}onTeamNameEnter(){return g(this,null,function*(){if(this.teamName.trim()){if(this.teams.includes(this.teamName.trim())){alert("Team name already exists. Please enter another name."),this.teamName="";return}this.selectedTeam=this.teamName.trim(),this.updateAvailablePlayers()}})}onAccept(){return g(this,null,function*(){if(this.mode==="create"){if(!this.teamName.trim()){alert("Please enter a team name");return}this.selectedTeam=this.teamName.trim()}if(!this.selectedTeam){alert("Please select or enter a team name");return}try{if(this.mode==="edit"){let t=yield this.dbService.getTeamMembers(this.selectedTeam);for(let e of t)yield this.dbService.removeTeamMember(this.selectedTeam,e)}for(let t of this.teamMembers)yield this.dbService.addTeamMember(this.selectedTeam,t.playerNumber),t.team=this.selectedTeam,yield this.dbService.addPlayer(t);yield this.loadTeams(),alert("Team entry completed!"),this.onCancel()}catch(t){console.error("Error saving team:",t),alert("Error saving team. Please try again.")}})}onCancel(){this.mode="create",this.teamName="",this.selectedTeam="",this.teamMembers=[],this.selectedPlayer=null,this.updateAvailablePlayers()}onReturn(){this.teamMembers.length>0&&confirm("Do you wish to accept the current team before returning to the main menu?")&&this.onAccept(),this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||i)(T(F),T(N))};static \u0275cmp=x({type:i,selectors:[["app-team-setup"]],decls:26,vars:8,consts:[[1,"team-setup-container"],[1,"team-setup-header"],[1,"btn","btn-secondary",3,"click"],[1,"team-setup-content"],[1,"mode-selection"],[1,"radio-label"],["type","radio","name","mode","value","create",3,"ngModelChange","change","ngModel"],["type","radio","name","mode","value","edit",3,"ngModelChange","change","ngModel"],["type","radio","name","mode","value","rename",3,"ngModelChange","change","ngModel"],[1,"form-section"],["class","form-group",4,"ngIf"],["class","team-members-list",4,"ngIf"],[1,"form-actions"],["type","button","class","btn",3,"click",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"form-group"],["for","teamName",1,"form-label"],["type","text","id","teamName","name","teamName","placeholder","Enter team name",1,"form-control",3,"ngModelChange","blur","ngModel"],["for","selectedTeam",1,"form-label"],["id","selectedTeam","name","selectedTeam",1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["for","playerSelect",1,"form-label"],["id","playerSelect","name","playerSelect",1,"form-control",3,"ngModelChange","change","ngModel"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"team-members-list"],[1,"member-list"],["class","member-item",4,"ngFor","ngForOf"],[1,"member-item"],[1,"btn","btn-danger","btn-small",3,"click"],["type","button",1,"btn",3,"click"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),s(3,"Quiz Master Team Set Up"),r(),o(4,"button",2),p("click",function(){return a.onReturn()}),s(5,"Return"),r()(),o(6,"div",3)(7,"div",4)(8,"label",5)(9,"input",6),f("ngModelChange",function(l){return y(a.mode,l)||(a.mode=l),l}),p("change",function(){return a.onModeChange("create")}),r(),s(10," Add a New Team "),r(),o(11,"label",5)(12,"input",7),f("ngModelChange",function(l){return y(a.mode,l)||(a.mode=l),l}),p("change",function(){return a.onModeChange("edit")}),r(),s(13," Change an Existing Team "),r(),o(14,"label",5)(15,"input",8),f("ngModelChange",function(l){return y(a.mode,l)||(a.mode=l),l}),p("change",function(){return a.onModeChange("rename")}),r(),s(16," Rename an Existing Team "),r()(),o(17,"div",9),b(18,B,4,1,"div",10)(19,j,7,2,"div",10)(20,Q,7,3,"div",10)(21,q,5,1,"div",11),o(22,"div",12),b(23,G,2,0,"button",13),o(24,"button",14),p("click",function(){return a.onCancel()}),s(25,"Clear"),r()()()()()),e&2&&(m(9),_("ngModel",a.mode),m(3),_("ngModel",a.mode),m(3),_("ngModel",a.mode),m(3),c("ngIf",a.mode==="create"),m(),c("ngIf",a.mode==="edit"||a.mode==="rename"),m(),c("ngIf",(a.mode==="edit"||a.mode==="create")&&(a.selectedTeam||a.teamName)),m(),c("ngIf",a.teamMembers.length>0),m(2),c("ngIf",a.teamMembers.length>0))},dependencies:[P,w,M,R,I,W,E,A,k,O,V],styles:[".team-setup-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,var(--xl-gray-light) 0%,var(--xl-white) 100%);padding:var(--spacing-xl)}.team-setup-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-xl);background:var(--xl-white);padding:var(--spacing-lg);border-radius:var(--radius-lg);box-shadow:var(--shadow-md)}.team-setup-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:var(--font-heading);font-size:2rem;color:var(--xl-blue-dark);font-weight:700}.team-setup-content[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.mode-selection[_ngcontent-%COMP%]{background:var(--xl-white);border-radius:var(--radius-lg);padding:var(--spacing-xl);margin-bottom:var(--spacing-lg);box-shadow:var(--shadow-lg);border:1px solid var(--xl-gray);display:flex;gap:var(--spacing-xl);flex-wrap:wrap}.radio-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);cursor:pointer;padding:var(--spacing-sm);border-radius:var(--radius-sm);transition:all var(--transition-base)}.radio-label[_ngcontent-%COMP%]:hover{background-color:var(--xl-blue-lighter)}.form-section[_ngcontent-%COMP%]{background:var(--xl-white);border-radius:var(--radius-lg);padding:var(--spacing-xl);box-shadow:var(--shadow-lg);border:1px solid var(--xl-gray)}.team-members-list[_ngcontent-%COMP%]{margin-top:var(--spacing-xl);padding-top:var(--spacing-lg);border-top:3px solid var(--xl-gold)}.team-members-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:var(--spacing-lg);color:var(--xl-blue-dark);font-size:1.25rem;font-weight:700;font-family:var(--font-heading)}.member-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-md)}.member-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:linear-gradient(135deg,var(--xl-gray-light) 0%,var(--xl-white) 100%);border-radius:var(--radius-md);border:1px solid var(--xl-gray);transition:all var(--transition-base)}.member-item[_ngcontent-%COMP%]:hover{transform:translate(4px);box-shadow:var(--shadow-md);border-color:var(--xl-blue)}.form-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-md);margin-top:var(--spacing-xl);padding-top:var(--spacing-lg);border-top:2px solid var(--xl-gray)}@media (max-width: 768px){.team-setup-container[_ngcontent-%COMP%]{padding:var(--spacing-md)}.mode-selection[_ngcontent-%COMP%]{flex-direction:column;gap:var(--spacing-md)}}"]})};export{D as TeamSetupComponent};
