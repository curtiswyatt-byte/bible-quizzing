import{a as N}from"./chunk-KODUIQMG.js";import{b as Q,c as S,f as D,h as I,j as k,k as P,l as O,p as W}from"./chunk-GJ3ACHC3.js";import{Ea as x,Fa as T,H as l,Ha as M,M as _,N as w,Na as E,R as y,W as h,X as r,Y as i,aa as q,ba as c,ca as f,d,ha as a,ia as V,ja as b,na as p,oa as m,pa as g,y as C,z as v}from"./chunk-45QSGMLT.js";function F(u,t){if(u&1&&(r(0,"span",34),a(1),i()),u&2){let o=f(2);l(),b("(",o.bookVersion,")")}}function B(u,t){if(u&1&&(r(0,"div",31)(1,"span",32),a(2),i(),y(3,F,2,1,"span",33),i()),u&2){let o=f();l(2),V(o.bookName),l(),h("ngIf",o.bookVersion)}}function L(u,t){if(u&1&&(r(0,"option",35),a(1),i()),u&2){let o=t.$implicit,e=f();h("value",o.typeID),l(),b(" ",e.formatTypeLabel(o)," ")}}function R(u,t){if(u&1){let o=q();r(0,"button",36),c("click",function(){C(o);let s=f();return v(s.onDelete())}),a(1,"Delete"),i()}}var A=class u{constructor(t,o){this.dbService=t;this.router=o}questions=[];types=[];filteredTypes=[];questionID=null;selectedType="";chapter=null;startVerse=null;endVerse=null;question="";answer="";verseText="";isNewQuestion=!1;showDelete=!1;bookName="";bookVersion="";ngOnInit(){return d(this,null,function*(){yield this.loadTypes(),yield this.loadQuestions();let t=yield this.dbService.getUserFile();t&&(this.bookName=t.book,this.bookVersion=t.bookVersion||"")})}loadTypes(){return d(this,null,function*(){this.types=yield this.dbService.getAllTypes(),this.filteredTypes=this.types.filter(t=>t.class==="B"||t.class==="Q")})}loadQuestions(){return d(this,null,function*(){this.questions=yield this.dbService.getAllQuestions(),this.questions.sort((t,o)=>t.questionID-o.questionID)})}onQuestionIDChange(){return d(this,null,function*(){if(!this.questionID||this.questionID<=0){if(this.questions.length>0){let o=Math.max(...this.questions.map(e=>e.questionID));this.questionID=o+1}else this.questionID=1;this.isNewQuestion=!0,this.clearForm();return}let t=yield this.dbService.getQuestion(this.questionID);t?(this.isNewQuestion=!1,this.showDelete=!0,this.selectedType=t.qDescType,this.chapter=t.qChapter,this.startVerse=t.qBegVerse,this.endVerse=t.qEndVerse,this.question=t.qdescription,this.answer=t.qAnswer,yield this.loadVerse()):(this.isNewQuestion=!0,this.showDelete=!1,this.clearForm())})}onChapterChange(){return d(this,null,function*(){this.chapter&&this.startVerse&&(yield this.loadVerse())})}onVerseChange(){return d(this,null,function*(){this.chapter&&this.startVerse&&((!this.endVerse||this.endVerse<this.startVerse)&&(this.endVerse=this.startVerse),yield this.loadVerse())})}loadVerse(){return d(this,null,function*(){if(this.chapter&&this.startVerse&&this.endVerse)try{this.verseText=yield this.dbService.getVerses(this.chapter,this.startVerse,this.endVerse),this.bookName&&(this.verseText+=`
(${this.bookName} ${this.chapter}:${this.startVerse}${this.startVerse!==this.endVerse?"-"+this.endVerse:""})`)}catch{this.verseText="Verse not found"}})}clearForm(){this.selectedType="",this.chapter=null,this.startVerse=null,this.endVerse=null,this.question="",this.answer="",this.verseText=""}onAccept(){return d(this,null,function*(){if(!this.questionID||this.questionID<=0){alert("Please enter a valid question ID");return}if(!this.selectedType){alert("Please select a question type");return}if(!this.chapter||!this.startVerse||!this.endVerse){alert("Please enter chapter and verse information");return}if(!this.question.trim()){alert("Question text is required");return}let t={questionID:this.questionID,qdescription:this.question.trim(),qAnswer:this.answer.trim()||" ",qChapter:this.chapter,qBegVerse:this.startVerse,qEndVerse:this.endVerse,qDescType:this.selectedType,book:this.bookName,version:this.bookVersion};try{yield this.dbService.addQuestion(t);let o={selectionID:this.questionID,selectType:this.selectedType,selChapter:this.chapter,selVerse:this.startVerse,primUseCnt:0,bonUseCnt:0};yield this.dbService.addQuestionSelect(o),yield this.loadQuestions(),this.onCancel(),alert("Question saved successfully!")}catch(o){console.error("Error saving question:",o),alert("Error saving question. Please try again.")}})}onCancel(){this.questionID=null,this.clearForm(),this.isNewQuestion=!1,this.showDelete=!1}onDelete(){return d(this,null,function*(){if(confirm("Are you sure you want to delete this question?")&&this.questionID)try{yield this.dbService.deleteQuestion(this.questionID),yield this.loadQuestions(),this.onCancel(),alert("Question deleted successfully!")}catch(t){console.error("Error deleting question:",t),alert("Error deleting question. Please try again.")}})}onVerseTextClick(){if(this.verseText&&window.getSelection){let t=window.getSelection();t&&t.toString()}}onReturn(){this.router.navigate(["/"])}formatTypeLabel(t){let e=(t.leadIn||"").trim().replace(/\s+/g," ").replace(/^(a|an)\s+/i,"").replace(/\s*question\.?$/i,"").trim();if(e){let s=e.toLowerCase().split(/\s+/).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ");return`${t.typeID} - ${s}`}return t.typeID}static \u0275fac=function(o){return new(o||u)(_(N),_(E))};static \u0275cmp=w({type:u,selectors:[["app-question-entry"]],decls:53,vars:11,consts:[[1,"question-entry-container"],[1,"question-entry-header"],[1,"header-left"],["class","book-info",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],[1,"question-entry-content"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["for","questionID",1,"form-label"],["type","number","id","questionID","name","questionID","placeholder","Auto",1,"form-control",3,"ngModelChange","blur","ngModel"],["for","questionType",1,"form-label"],["id","questionType","name","selectedType",1,"form-control",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","chapter",1,"form-label"],["type","number","id","chapter","name","chapter",1,"form-control",3,"ngModelChange","blur","ngModel"],["for","startVerse",1,"form-label"],["type","number","id","startVerse","name","startVerse",1,"form-control",3,"ngModelChange","blur","ngModel"],["for","endVerse",1,"form-label"],["type","number","id","endVerse","name","endVerse",1,"form-control",3,"ngModelChange","blur","ngModel"],["for","question",1,"form-label"],["id","question","name","question","rows","3","placeholder","Enter question text",1,"form-control","textarea",3,"ngModelChange","ngModel"],["for","answer",1,"form-label"],["id","answer","name","answer","rows","2","placeholder","Enter answer",1,"form-control","textarea",3,"ngModelChange","ngModel"],[1,"form-label"],["name","verseText","rows","6","readonly","",1,"form-control","textarea","verse-text",3,"ngModelChange","click","ngModel"],[1,"form-actions"],["type","button",1,"btn",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],[1,"book-info"],[1,"book-name"],["class","book-version",4,"ngIf"],[1,"book-version"],[3,"value"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(o,e){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),a(4,"Quiz Question Entry"),i(),y(5,B,4,2,"div",3),i(),r(6,"button",4),c("click",function(){return e.onReturn()}),a(7,"Return"),i()(),r(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8)(12,"label",9),a(13,"Question ID:"),i(),r(14,"input",10),g("ngModelChange",function(n){return m(e.questionID,n)||(e.questionID=n),n}),c("blur",function(){return e.onQuestionIDChange()}),i()(),r(15,"div",8)(16,"label",11),a(17,"Question Type:"),i(),r(18,"select",12),g("ngModelChange",function(n){return m(e.selectedType,n)||(e.selectedType=n),n}),r(19,"option",13),a(20,"Select Type"),i(),y(21,L,2,2,"option",14),i()()(),r(22,"div",7)(23,"div",8)(24,"label",15),a(25,"Chapter:"),i(),r(26,"input",16),g("ngModelChange",function(n){return m(e.chapter,n)||(e.chapter=n),n}),c("blur",function(){return e.onChapterChange()}),i()(),r(27,"div",8)(28,"label",17),a(29,"Verse:"),i(),r(30,"input",18),g("ngModelChange",function(n){return m(e.startVerse,n)||(e.startVerse=n),n}),c("blur",function(){return e.onVerseChange()}),i()(),r(31,"div",8)(32,"label",19),a(33,"End Verse:"),i(),r(34,"input",20),g("ngModelChange",function(n){return m(e.endVerse,n)||(e.endVerse=n),n}),c("blur",function(){return e.onVerseChange()}),i()()(),r(35,"div",8)(36,"label",21),a(37,"Question:"),i(),r(38,"textarea",22),g("ngModelChange",function(n){return m(e.question,n)||(e.question=n),n}),i()(),r(39,"div",8)(40,"label",23),a(41,"Answer:"),i(),r(42,"textarea",24),g("ngModelChange",function(n){return m(e.answer,n)||(e.answer=n),n}),i()(),r(43,"div",8)(44,"label",25),a(45,"Passage:"),i(),r(46,"textarea",26),g("ngModelChange",function(n){return m(e.verseText,n)||(e.verseText=n),n}),c("click",function(){return e.onVerseTextClick()}),i()(),r(47,"div",27)(48,"button",28),c("click",function(){return e.onAccept()}),a(49,"Accept"),i(),r(50,"button",29),c("click",function(){return e.onCancel()}),a(51,"Cancel"),i(),y(52,R,2,0,"button",30),i()()()()),o&2&&(l(5),h("ngIf",e.bookName),l(9),p("ngModel",e.questionID),l(4),p("ngModel",e.selectedType),l(3),h("ngForOf",e.filteredTypes),l(5),p("ngModel",e.chapter),l(4),p("ngModel",e.startVerse),l(4),p("ngModel",e.endVerse),l(4),p("ngModel",e.question),l(4),p("ngModel",e.answer),l(4),p("ngModel",e.verseText),l(6),h("ngIf",e.showDelete))},dependencies:[M,x,T,W,P,O,Q,I,k,S,D],styles:[".question-entry-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,var(--xl-gray-light) 0%,var(--xl-white) 100%);padding:var(--spacing-xl)}.question-entry-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-xl);background:var(--xl-white);padding:var(--spacing-lg);border-radius:var(--radius-lg);box-shadow:var(--shadow-md)}.header-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-xs)}.question-entry-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:var(--font-heading);font-size:2rem;color:var(--xl-blue-dark);font-weight:700;margin:0}.book-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);font-size:1rem}.book-name[_ngcontent-%COMP%]{font-weight:600;color:var(--xl-blue)}.book-version[_ngcontent-%COMP%]{color:var(--xl-gray-dark);font-style:italic}.question-entry-content[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto}.form-section[_ngcontent-%COMP%]{background:var(--xl-white);border-radius:var(--radius-lg);padding:var(--spacing-xl);box-shadow:var(--shadow-lg);border:1px solid var(--xl-gray)}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:var(--spacing-lg);margin-bottom:var(--spacing-lg)}.textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px;font-family:var(--font-primary);line-height:1.6}.verse-text[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--xl-gold-lighter) 0%,var(--xl-white) 100%);font-family:Georgia,Times New Roman,serif;font-size:1rem;line-height:1.8;border:2px solid var(--xl-gold-light);padding:var(--spacing-lg);border-radius:var(--radius-md)}.form-actions[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-md);margin-top:var(--spacing-xl);padding-top:var(--spacing-lg);border-top:2px solid var(--xl-gray)}@media (max-width: 768px){.question-entry-container[_ngcontent-%COMP%]{padding:var(--spacing-md)}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{A as QuestionEntryComponent};
